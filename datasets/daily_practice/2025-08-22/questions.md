## Scenario 1: Calculating Net Revenue per Product

**Objective:** The finance department needs a clear picture of the true revenue generated by each product, accounting for the cost of returns and the benefit of reselling restocked items.

Task: For each product_id, calculate its net_revenue. The calculation should be:

SUM(price of all initial sales) - SUM(price of all returned sales) + SUM(price of all resales of restocked items).

An "initial sale" is any 'SALE' event. A "returned sale" is an initial sale that is followed by a `RETURN_PROCESSED` event. A "resale" is a 'SALE' event that happens *after* a `RETURN_PROCESSED` event for the same `item_sku`.

**Expected Output:**

| **product_id** | **net_revenue** |
| -------------------- | --------------------- |
| 101                  | 50.00                 |
| 102                  | 70.00                 |
| 103                  | 0.00                  |
| 104                  | 180.00                |

**Your Solution:**

```sql
-- Write your solution here
```

## Scenario 2: Return Rate by Reason and Time-to-Return

**Objective:** As a product analyst, you want to understand *why* items are returned and *how quickly* customers decide to return them.

**Task:** For each distinct return `reason`, calculate:

1. `return_count`: The total number of items returned for this reason.
2. `avg_days_to_return`: The average number of days between the initial 'SALE' event and the 'RETURN_REQUEST' event for items returned for this reason.

The final report should be ordered by `return_count` in descending order.

**Expected Output:**

| **reason** | **return_count** | **avg_days_to_return** |
| ---------------- | ---------------------- | ---------------------------- |
| Wrong Size       | 2                      | 3.50                         |
| Changed Mind     | 2                      | 4.00                         |
| Defective        | 2                      | 3.50                         |

**Your Solution:**

```sql
-- Write your solution here
```

## Scenario 3: Identifying "Zombie" Returns

**Objective:** The logistics team is concerned about "zombie" returnsâ€”items where a return was requested but the item never made it back to the warehouse to be processed.

**Task:** Write a query to identify all `item_sku`s that have a `RETURN_REQUEST` event but do not have a subsequent `RETURN_PROCESSED` event. For these items, calculate the number of `days_since_request` as of '2023-12-01'.

The final report should show the `item_sku`, the `product_id`, the `order_id` of the return, and the `days_since_request`.

**Expected Output:**

| **item_sku** | **product_id** | **order_id** | **days_since_request** |
| ------------------ | -------------------- | ------------------ | ---------------------------- |
| SKU-E-001          | 102                  | ORD-005            | 22                           |

**Your Solution:**

```sql
-- Write your solution here
```
