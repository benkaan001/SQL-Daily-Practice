CREATE DATABASE IF NOT EXISTS daily_practice_20251029_schema;
USE daily_practice_20251029_schema;

-- This table logs incoming requests handled by different backend servers via a load balancer.
CREATE TABLE load_balancer_logs (
    log_id INT PRIMARY KEY AUTO_INCREMENT,
    request_timestamp DATETIME(3),
    client_ip VARCHAR(50),
    server_id VARCHAR(10), -- e.g., 'srv-A', 'srv-B'
    response_time_ms INT,
    status_code INT
);

INSERT INTO load_balancer_logs (request_timestamp, client_ip, server_id, response_time_ms, status_code) VALUES
-- Window 1: 10:00 - 10:10 (Server B is slow)
('2023-11-15 10:00:15.100', '192.168.1.10', 'srv-A', 110, 200),
('2023-11-15 10:00:30.250', '192.168.1.11', 'srv-B', 280, 200),
('2023-11-15 10:01:05.500', '192.168.1.12', 'srv-C', 100, 200),
('2023-11-15 10:01:45.900', '192.168.1.10', 'srv-A', 90, 200),
('2023-11-15 10:02:10.100', '192.168.1.13', 'srv-B', 320, 200),
('2023-11-15 10:02:40.300', '192.168.1.11', 'srv-B', 300, 200),
('2023-11-15 10:03:15.700', '192.168.1.14', 'srv-C', 120, 200),
('2023-11-15 10:03:50.000', '192.168.1.10', 'srv-B', 310, 200),
('2023-11-15 10:04:20.500', '192.168.1.15', 'srv-A', 105, 200),
('2023-11-15 10:04:55.800', '192.168.1.11', 'srv-B', 290, 200),
('2023-11-15 10:05:30.200', '192.168.1.12', 'srv-B', 305, 200),
('2023-11-15 10:06:00.600', '192.168.1.16', 'srv-C', 110, 200),
('2023-11-15 10:06:40.150', '192.168.1.10', 'srv-B', 325, 503), -- Server B error under load
('2023-11-15 10:07:15.400', '192.168.1.17', 'srv-A', 95, 200),
('2023-11-15 10:07:50.750', '192.168.1.11', 'srv-B', 330, 503),
('2023-11-15 10:08:25.000', '192.168.1.18', 'srv-C', 100, 200),
('2023-11-15 10:09:00.300', '192.168.1.10', 'srv-B', 315, 200),
('2023-11-15 10:09:30.900', '192.168.1.19', 'srv-A', 100, 200),
('2023-11-15 10:09:55.100', '192.168.1.11', 'srv-B', 295, 200), -- End Window 1 (11 reqs on B)

-- Window 2: 10:10 - 10:20 (Normal operation)
('2023-11-15 10:10:10.000', '192.168.1.20', 'srv-A', 100, 200),
('2023-11-15 10:11:20.500', '192.168.1.21', 'srv-B', 120, 200),
('2023-11-15 10:12:30.800', '192.168.1.22', 'srv-C', 115, 200),
('2023-11-15 10:13:40.100', '192.168.1.20', 'srv-A', 95, 200),
('2023-11-15 10:14:50.400', '192.168.1.23', 'srv-B', 110, 200),
('2023-11-15 10:15:55.700', '192.168.1.21', 'srv-C', 105, 200), -- End Window 2

-- Window 3: 10:20 - 10:30 (Server A is slow, but few requests)
('2023-11-15 10:20:05.000', '192.168.1.24', 'srv-A', 350, 200),
('2023-11-15 10:21:15.200', '192.168.1.25', 'srv-B', 100, 200),
('2023-11-15 10:22:25.400', '192.168.1.26', 'srv-C', 110, 200),
('2023-11-15 10:23:35.600', '192.168.1.24', 'srv-A', 360, 200), -- End Window 3 (Only 2 reqs on A)

-- Window 4: 10:30 - 10:40 (Server C slow and busy)
('2023-11-15 10:30:10.100', '192.168.1.30', 'srv-A', 100, 200),
('2023-11-15 10:30:40.200', '192.168.1.31', 'srv-B', 110, 200),
('2023-11-15 10:31:15.300', '192.168.1.32', 'srv-C', 250, 200),
('2023-11-15 10:31:50.400', '192.168.1.33', 'srv-C', 260, 200),
('2023-11-15 10:32:25.500', '192.168.1.34', 'srv-C', 270, 200),
('20_3-11-15 10:33:00.600', '192.168.1.30', 'srv-A', 90, 200),
('2023-11-15 10:33:35.700', '192.168.1.35', 'srv-C', 240, 200),
('2023-11-15 10:34:10.800', '192.168.1.31', 'srv-B', 105, 200),
('2023-11-15 10:34:45.900', '192.168.1.36', 'srv-C', 280, 200),
('2023-11-15 10:35:20.000', '192.168.1.32', 'srv-C', 265, 200),
('2023-11-15 10:35:55.100', '192.168.1.37', 'srv-C', 275, 200),
('2023-11-15 10:36:30.200', '192.168.1.30', 'srv-C', 290, 500),
('2023-11-15 10:37:05.300', '192.168.1.38', 'srv-A', 110, 200),
('2023-11-15 10:37:40.400', '192.168.1.31', 'srv-C', 285, 500),
('2023-11-15 10:38:15.500', '192.168.1.39', 'srv-B', 115, 200),
('2023-11-15 10:38:50.600', '192.168.1.32', 'srv-C', 295, 200),
('2023-11-15 10:39:25.700', '192.168.1.40', 'srv-A', 95, 200),
('2023-11-15 10:39:55.800', '192.168.1.33', 'srv-C', 300, 200); -- End Window 4 (12 reqs on C)
