-- Create the database and table for client calls at Redfin
CREATE DATABASE IF NOT EXISTS daily_practice_20250412_schema;
USE daily_practice_20250412_schema;

-- Create the orders table
CREATE TABLE delivery_orders (
    customer_placed_order_datetime DATETIME,
    placed_order_with_restaurant_datetime DATETIME,
    driver_at_restaurant_datetime DATETIME,
    delivered_to_consumer_datetime DATETIME,  -- This column is nullable when no value is provided
    driver_id INT,
    restaurant_id INT,
    consumer_id INT,
    is_new TINYINT,
    delivery_region VARCHAR(50),
    is_asap TINYINT,
    order_total DECIMAL(10,2),
    discount_amount DECIMAL(10,2),
    tip_amount DECIMAL(10,2),
    refunded_amount DECIMAL(10,2)
);

-- Insert sample data (only first 10 rows shown; continue similarly for rows 11 to 65)
INSERT INTO delivery_orders VALUES
('2020-05-25 16:36:00', '2020-05-25 18:17:00', '2020-05-25 18:47:00', NULL, 257, 154, 190327, 1, 'San Jose', 0, 36.99, 6.00, 1.42, 0.00),
('2020-05-02 16:32:00', '2020-05-02 17:59:00', '2020-05-02 18:50:00', NULL, 168, 297, 12420, 0, 'San Jose', 0, 32.71, 0.00, 3.67, 0.00),
('2020-05-24 16:38:00', '2020-05-24 20:03:00', '2020-05-24 20:37:00', '2020-05-24 20:49:00', 290, 201, 106412, 1, 'San Jose', 0, 33.35, 6.00, 1.25, 0.00),
('2020-05-17 17:34:00', '2020-05-17 18:01:00', '2020-05-17 18:09:00', '2020-05-17 18:35:00', 232, 188, 104751, 0, 'San Jose', 0, 33.02, 6.00, 2.48, 0.00),
('2020-05-24 17:40:00', '2020-05-24 18:04:00', '2020-05-24 18:51:00', NULL, 290, 135, 13641, 1, 'San Jose', 0, 24.49, 6.00, 2.45, 0.00),
('2020-05-26 17:52:00', '2020-05-26 18:11:00', '2020-05-26 18:58:00', NULL, 290, 188, 25845, 1, 'San Jose', 0, 14.65, 0.00, 1.19, 0.00),
('2020-05-29 17:48:00', '2020-05-29 18:11:00', '2020-05-29 18:23:00', '2020-05-29 19:03:00', 123, 383, 24289, 1, 'San Jose', 0, 33.08, 0.00, 1.24, 0.00),
('2020-05-15 17:55:00', '2020-05-15 18:02:00', '2020-05-15 18:18:00', '2020-05-15 19:06:00', 123, 298, 96518, 0, 'San Jose', 0, 15.27, 0.00, 0.85, 0.00),
('2020-05-11 01:53:00', '2020-05-11 01:59:00', '2020-05-11 02:31:00', '2020-05-11 02:52:00', 249, 271, 80397, 0, 'San Jose', 1, 58.16, 0.00, 8.72, 0.00),
('2020-05-09 03:23:00', '2020-05-09 03:28:00', '2020-05-09 03:37:00', '2020-05-09 04:09:00', 36, 170, 85485, 1, 'San Jose', 1, 27.70, 0.00, 0.99, 0.00);


INSERT INTO delivery_orders VALUES
-- Row 11
('2020-05-27 03:04:00', '2020-05-27 03:13:00', NULL, '2020-05-27 04:07:00', 177, 170, 100508, 0, 'San Jose', 1, 54.32, 6.00, 8.00, 0.00),
-- Row 12
('2020-05-30 04:04:00', '2020-05-30 04:05:00', '2020-05-30 04:21:00', '2020-05-30 04:59:00', 168, 253, 11362, 0, 'San Jose', 1, 33.68, 0.00, 1.68, 0.00),
-- Row 13
('2020-05-25 01:14:00', '2020-05-25 01:17:00', NULL, '2020-05-25 01:42:00', 168, 194, 158375, 1, 'San Jose', 1, 29.38, 6.00, 2.15, 0.00),
-- Row 14
('2020-05-14 21:54:00', '2020-05-14 23:09:00', '2020-05-14 23:47:00', '2020-05-15 00:17:00', 249, 282, 100052, 0, 'San Jose', 0, 141.44, 6.00, 5.93, 0.00),
-- Row 15
('2020-05-12 01:46:00', '2020-05-12 02:05:00', '2020-05-12 02:30:00', '2020-05-12 02:53:00', 243, 194, 95225, 0, 'San Jose', 1, 38.08, 6.00, 2.00, 0.00),
-- Row 16
('2020-05-15 23:08:00', '2020-05-15 23:37:00', '2020-05-15 23:59:00', '2020-05-16 00:15:00', 257, 128, 11030, 0, 'San Jose', 0, 48.41, 0.00, 4.84, 0.00),
-- Row 17
('2020-05-18 23:55:00', '2020-05-19 00:00:00', '2020-05-19 00:18:00', '2020-05-19 00:43:00', 373, 181, 107004, 0, 'San Jose', 1, 33.19, 6.00, 1.25, 0.00),
-- Row 18
('2020-05-02 04:18:00', '2020-05-02 04:19:00', '2020-05-02 04:30:00', '2020-05-02 05:12:00', 227, 281, 47494, 0, 'San Jose', 1, 40.28, 0.00, 4.71, 0.00),
-- Row 19
('2020-05-28 00:52:00', '2020-05-28 01:55:00', '2020-05-28 01:30:00', '2020-05-28 02:04:00', 131, 346, 59208, 0, 'San Jose', 1, 38.63, 6.00, 1.93, 0.00),
-- Row 20
('2020-05-15 23:10:00', '2020-05-15 23:21:00', '2020-05-16 00:08:00', '2020-05-16 00:40:00', 317, 356, 100052, 0, 'San Jose', 0, 169.80, 0.00, 5.00, 0.00),
-- Row 21
('2020-05-05 19:54:00', '2020-05-05 19:57:00', '2020-05-05 20:19:00', '2020-05-05 20:39:00', 220, 201, 11101, 0, 'San Jose', 1, 33.68, 0.00, 5.05, 0.00),
-- Row 22
('2020-05-03 00:25:00', '2020-05-03 00:29:00', '2020-05-03 00:38:00', '2020-05-03 01:10:00', 336, 194, 78537, 1, 'San Jose', 1, 51.13, 6.00, 6.22, 0.00),
-- Row 23
('2020-05-09 19:37:00', '2020-05-09 19:42:00', '2020-05-09 19:50:00', '2020-05-09 20:12:00', 232, 309, 83710, 0, 'San Jose', 1, 52.02, 0.00, 4.22, 0.00),
-- Row 24
('2020-05-10 23:51:00', '2020-05-10 23:54:00', '2020-05-11 00:13:00', '2020-05-11 00:35:00', 317, 190, 90201, 1, 'San Jose', 1, 36.23, 0.00, 1.81, 0.00),
-- Row 25
('2020-05-14 16:01:00', '2020-05-14 17:55:00', '2020-05-14 18:20:00', '2020-05-14 18:45:00', 144, 258, 10294, 0, NULL, NULL, 94.84, 0.00, 10.00, 0.00),
-- Row 26
('2020-05-03 05:35:00', NULL, NULL, '2020-05-03 18:39:00', 34, 11, 79146, 1, NULL, NULL, 673.75, 0.00, 0.00, 0.00),
-- Row 27
('2020-05-19 01:06:00', '2020-05-19 01:07:00', '2020-05-19 01:15:00', '2020-05-19 01:27:00', 156, 8, 107202, 0, 'Palo Alto', 1, 24.71, 6.00, 1.72, 0.00),
-- Row 28
('2020-05-12 00:47:00', '2020-05-12 00:49:00', NULL, '2020-05-12 01:24:00', 345, 211, 94720, 0, 'Palo Alto', 1, 14.65, 6.00, 0.39, 0.00),
-- Row 29
('2020-05-04 00:13:00', '2020-05-04 00:13:00', '2020-05-04 00:24:00', '2020-05-04 01:01:00', 325, 62, 74914, 0, 'Palo Alto', 1, 29.33, 0.00, 2.14, 0.00),
-- Row 30
('2020-05-18 04:44:00', '2020-05-18 04:45:00', '2020-05-18 04:51:00', '2020-05-18 05:05:00', 311, 20, 92715, 0, 'Palo Alto', 1, 24.16, 0.00, 2.50, 0.00),
-- Row 31
('2020-05-13 04:07:00', '2020-05-13 04:12:00', '2020-05-13 04:19:00', '2020-05-13 04:34:00', 43, 9, 97626, 0, 'Palo Alto', 1, 17.42, 6.00, 0.87, 0.00),
-- Row 32
('2020-05-29 17:28:00', '2020-05-29 17:36:00', '2020-05-29 18:23:00', '2020-05-29 18:42:00', 267, 20, 7081, 0, 'Palo Alto', 0, 70.49, 0.00, 2.96, 0.00),
-- Row 33
('2020-05-23 18:16:00', '2020-05-23 18:21:00', '2020-05-23 18:27:00', '2020-05-23 19:03:00', 216, 124, 4087, 0, 'Palo Alto', 1, 70.71, 0.00, 2.97, 0.00),
-- Row 34
('2020-05-01 20:16:00', '2020-05-01 20:19:00', '2020-05-01 20:38:00', '2020-05-01 20:48:00', 288, 233, 2731, 0, 'Palo Alto', 1, 22.73, 0.00, 2.30, 0.00),
-- Row 35
('2020-05-02 18:12:00', '2020-05-03 01:52:00', '2020-05-03 02:31:00', '2020-05-03 02:50:00', 245, 45, 13607, 0, 'Mountain View', 0, 47.22, 6.00, 4.72, 0.00),
-- Row 36
('2020-05-26 00:11:00', '2020-05-26 00:16:00', NULL, '2020-05-26 00:41:00', 144, 83, 4686, 1, 'Palo Alto', 1, 16.33, 0.00, 0.82, 0.00),
-- Row 37
('2020-05-26 20:31:00', '2020-05-26 20:39:00', '2020-05-26 20:52:00', '2020-05-26 21:17:00', 424, 106, 1226, 0, 'Palo Alto', 1, 51.13, 0.00, 5.00, 0.00),
-- Row 38
('2020-05-06 01:20:00', '2020-05-06 01:20:00', '2020-05-06 01:31:00', '2020-05-06 01:51:00', 276, 8, 35765, 0, 'Palo Alto', 1, 36.40, 6.00, 1.39, 0.00),
-- Row 39
('2020-05-19 00:33:00', '2020-05-19 00:38:00', NULL, '2020-05-19 01:00:00', 314, 48, 12510, 0, 'Palo Alto', 1, 23.89, 0.00, 4.00, 0.00),
-- Row 40
('2020-05-18 01:55:00', '2020-05-18 01:57:00', '2020-05-18 02:10:00', '2020-05-18 02:19:00', 208, 43, 9503, 0, 'Mountain View', 1, 17.36, 0.00, 0.00, 0.00);