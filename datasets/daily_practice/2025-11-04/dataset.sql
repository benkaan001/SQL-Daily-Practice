CREATE DATABASE IF NOT EXISTS daily_practice_20251104_schema;
USE daily_practice_20251104_schema;

-- This table logs every time a song is played on a music streaming service.
CREATE TABLE song_plays (
    play_id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT,
    song_id INT,
    artist_id INT,
    play_timestamp DATETIME(3),
    platform VARCHAR(50)
);

INSERT INTO song_plays (user_id, song_id, artist_id, play_timestamp, platform) VALUES
-- Song 1001 (Artist 50): Becomes a viral hit
(101, 1001, 50, '2023-10-10 08:05:00.000', 'mobile'),
(102, 1001, 50, '2023-10-10 09:10:00.000', 'web'),
(101, 1001, 50, '2023-10-11 08:15:00.000', 'mobile'),
(102, 1001, 50, '2023-10-11 09:20:00.000', 'web'),
(103, 1001, 50, '2023-10-11 10:30:00.000', 'mobile'),
(104, 1001, 50, '2023-10-11 11:35:00.000', 'mobile'),
(101, 1001, 50, '2023-10-12 08:20:00.000', 'web'),
(102, 1001, 50, '2023-10-12 09:25:00.000', 'mobile'),
(103, 1001, 50, '2023-10-12 10:40:00.000', 'mobile'),
(104, 1001, 50, '2023-10-12 11:45:00.000', 'web'),
(105, 1001, 50, '2023-10-12 13:00:00.000', 'mobile'),
(106, 1001, 50, '2023-10-12 14:10:00.000', 'web'),
(107, 1001, 50, '2023-10-12 15:15:00.000', 'mobile'),
(108, 1001, 50, '2023-10-12 16:20:00.000', 'mobile'),
(101, 1001, 50, '2023-10-13 08:25:00.000', 'web'),
(102, 1001, 50, '2023-10-13 09:30:00.000', 'mobile'),
(103, 1001, 50, '2023-10-13 10:45:00.000', 'web'),
(104, 1001, 50, '2023-10-13 11:50:00.000', 'mobile'),
(105, 1001, 50, '2023-10-13 13:05:00.000', 'web'),
(106, 1001, 50, '2023-10-13 14:15:00.000', 'mobile'),
(107, 1001, 50, '2023-10-13 15:20:00.000', 'web'),
(108, 1001, 50, '2023-10-13 16:25:00.000', 'mobile'),
(109, 1001, 50, '2023-10-13 17:30:00.000', 'web'),
(110, 1001, 50, '2023-10-13 18:35:00.000', 'mobile'),
(111, 1001, 50, '2023-10-13 19:40:00.000', 'web'),
(112, 1001, 50, '2023-10-13 20:45:00.000', 'mobile'),
(113, 1001, 50, '2023-10-13 21:50:00.000', 'web'),
(114, 1001, 50, '2023-10-13 22:55:00.000', 'mobile'),
(115, 1001, 50, '2023-10-13 23:59:00.000', 'web'),

-- Song 1002 (Artist 50): Fails to go viral (no 3-day streak)
(101, 1002, 50, '2023-10-15 10:00:00.000', 'mobile'),
(102, 1002, 50, '2023-10-15 11:00:00.000', 'web'),
(101, 1002, 50, '2023-10-16 10:05:00.000', 'mobile'),
(102, 1002, 50, '2023-10-16 11:05:00.000', 'web'),
(103, 1002, 50, '2023-10-16 12:05:00.000', 'mobile'),
(104, 1002, 50, '2023-10-16 13:05:00.000', 'web'),
(105, 1002, 50, '2023-10-16 14:05:00.000', 'mobile'),
(101, 1002, 50, '2023-10-17 10:10:00.000', 'web'), -- Growth streak broken (5 plays to 1 play)
(101, 1002, 50, '2023-10-18 10:15:00.000', 'mobile'),
(102, 1002, 50, '2023-10-18 11:15:00.000', 'web'),
(103, 1002, 50, '2023-10-18 12:15:00.000', 'mobile'),

-- Song 2001 (Artist 55): Viral, but streak is only 2 days
(101, 2001, 55, '2023-10-20 09:00:00.000', 'web'),
(102, 2001, 55, '2023-10-20 09:30:00.000', 'mobile'),
(101, 2001, 55, '2023-10-21 09:05:00.000', 'web'),
(102, 2001, 55, '2023-10-21 09:35:00.000', 'mobile'),
(103, 2001, 55, '2023-10-21 10:05:00.000', 'web'),
(104, 2001, 55, '2023-10-21 10:35:00.000', 'mobile'),
(105, 2001, 55, '2023-10-21 11:05:00.000', 'web'),
(101, 2001, 55, '2023-10-22 09:10:00.000', 'mobile'), -- Growth streak broken (5 plays to 1 play)
(102, 2001, 55, '2023-10-23 09:15:00.000', 'web'),
(103, 2001, 55, '2023-10-23 09:45:00.000', 'mobile');
