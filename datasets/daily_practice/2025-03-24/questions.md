## Question 1: Window Functions

Write a SQL query to find the highest paid employee in each department, along with their salary rank across the entire company. Also include what percentage their salary is of the total salary of all employees in their department.

**Expected Output Format:**

| department_name | employee_name   | salary   | company_rank | dept_salary_percentage |
| --------------- | --------------- | -------- | ------------ | ---------------------- |
| Finance         | Lisa Anderson   | 92000.00 | 1            | 58.97                  |
| Engineering     | John Smith      | 85000.00 | 2            | 28.33                  |
| Sales           | James Martinez  | 81000.00 | 3            | 34.32                  |
| Marketing       | Emily Davis     | 68000.00 | 4            | 52.31                  |
| HR              | Jennifer Thomas | 59000.00 | 5            | 100.00                 |

**Your Solution:**
```sql
-- Write your solution here
```


## Question 2: Common Table Expressions (CTE)

Write a SQL query to find employees who are working on more than one project. For these employees, return their full name, a list of the project names they are involved in, their roles in these projects, and the total duration (in days) of all the projects they are working on.

**Expected Output Format:**
| employee_name | project_names                 | roles                                     | total_project_druation_days |
| ------------- | ----------------------------- | ----------------------------------------- | --------------------------- |
| Jane Smith    | Project Alpha | Project Beta  | Software Engineer | Technical Contributor | 1170                        |
| John Doe      | Project Alpha | Project Gamma | Lead Engineer | Technical Lead            | 1184                        |


**Your Solution:**
```sql
-- Write your solution here

```

